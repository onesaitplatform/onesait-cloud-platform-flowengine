<html>
	<script type="text/javascript">
	var auth = getParameterByName('authentication');
		RED.nodes.registerType('onesaitplatform-query-dynamic',{
			category: 'function',
			color: '#C0DEED',
			defaults: {
				name: {value:""},
				authentication: {value: auth}
			},
			inputs: 1,
			outputs:1,
			icon: "platform_logo.png",
			label: function() {
				return this.name||"onesaitplatform-query-dynamic";
			}
		});
	 function getParameterByName(name, url) {
     	
		    if (!url) {
		      url = window.location.href;
		    }
		    name = name.replace(/[\[\]]/g, "\\$&");
		    var regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)"),
		        results = regex.exec(url);
		    if (!results) return null;
		    if (!results[2]) return '';
		    return decodeURIComponent(results[2].replace(/\+/g, " "));
		}
	</script>

	<script type="text/x-red" data-template-name="onesaitplatform-query-dynamic">
		<div class="form-row">
			<label for="node-input-name"><i class="icon-file"></i> Name</label>
			<input type="text" id="node-input-name" placeholder="Name">
		</div>
	</script>

	<script type="text/x-red" data-help-name="onesaitplatform-query-dynamic">
		<p>Node querying the data bases Dynamically, the node expects the following attributes in the input message:</p>
		<p><code>ontology</code>  Name of the ontology to be referenced. It represents the domain model that handles a Thing.</p>
	    <p><code>queryType</code> Language of the query, it could be SQL-Like (Select * from collection;) or Native (db.collection.find()).</p>
	    <p><code>query</code> This is the query that are going to be launched</p>
		<p>Form attributes:</p>
		<p><code>Name</code> It is used to identity the node by a specific name. 
		This is an optional field.</p>
		<p>The output message has the following attributes:</p>
		<p><code>payload</code>The result of the query, if the query is a SELECT. </p>
		<p><code>ok</code>A boolean that specifies whether the query was ok</p>
	</script>
</html>
