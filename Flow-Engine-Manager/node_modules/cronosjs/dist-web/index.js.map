{"version":3,"file":"index.js","sources":["../dist-src/utils.js","../dist-src/parser.js","../dist-src/date.js","../dist-src/expression.js","../dist-src/scheduler.js","../dist-src/index.js"],"sourcesContent":["export const sortAsc = (a, b) => a - b;\r\n//# sourceMappingURL=utils.js.map","import { CronosExpression } from './expression';\r\nimport { sortAsc } from './utils';\r\nconst predefinedCronStrings = {\r\n    '@yearly': '0 0 0 1 1 * *',\r\n    '@annually': '0 0 0 1 1 * *',\r\n    '@monthly': '0 0 0 1 * * *',\r\n    '@weekly': '0 0 0 * * 0 *',\r\n    '@daily': '0 0 0 * * * *',\r\n    '@midnight': '0 0 0 * * * *',\r\n    '@hourly': '0 0 * * * * *',\r\n};\r\nconst monthReplacements = ['jan', 'feb', 'mar', 'apr', 'may', 'jun', 'jul', 'aug', 'sep', 'oct', 'nov', 'dec'];\r\nconst monthReplacementRegex = new RegExp(monthReplacements.join('|'), 'g');\r\nconst dayOfWeekReplacements = ['sun', 'mon', 'tue', 'wed', 'thu', 'fri', 'sat'];\r\nconst dayOfWeekReplacementRegex = new RegExp(dayOfWeekReplacements.join('|'), 'g');\r\n/*\r\n\"The actual range of times supported by ECMAScript Date objects is slightly smaller:\r\n  exactly â€“100,000,000 days to 100,000,000 days measured relative to midnight at the\r\n  beginning of 01 January, 1970 UTC. This gives a range of 8,640,000,000,000,000\r\n  milliseconds to either side of 01 January, 1970 UTC.\"\r\nhttp://ecma-international.org/ecma-262/5.1/#sec-15.9.1.1\r\n\r\nnew Date(8640000000000000) => 00:00:00 13th Sep 275760\r\nLargest full year valid as JS date = 275759\r\n*/\r\nconst maxValidYear = 275759;\r\nexport function _parse(cronstring) {\r\n    let expr = cronstring.trim().toLowerCase();\r\n    if (predefinedCronStrings[expr]) {\r\n        expr = predefinedCronStrings[expr];\r\n    }\r\n    const fields = expr.split(/\\s+/g);\r\n    if (fields.length < 5 || fields.length > 7) {\r\n        throw new Error('Expression must have at least 5 fields, and no more than 7 fields');\r\n    }\r\n    switch (fields.length) {\r\n        case 5:\r\n            fields.unshift('0');\r\n        case 6:\r\n            fields.push('*');\r\n    }\r\n    return new CronosExpression(cronstring, new SecondsOrMinutesField(fields[0]).values, new SecondsOrMinutesField(fields[1]).values, new HoursField(fields[2]).values, new DaysField(fields[3], fields[5]).values, new MonthsField(fields[4]).values, new YearsField(fields[6]));\r\n}\r\nclass Field {\r\n    constructor(field) {\r\n        this.field = field;\r\n    }\r\n    parse() {\r\n        return this.field.split(',')\r\n            .map(item => FieldItem.parse(item, this.first, this.last, true));\r\n    }\r\n    get items() {\r\n        if (!this._items)\r\n            this._items = this.parse();\r\n        return this._items;\r\n    }\r\n    get values() {\r\n        return Field.getValues(this.items, this.first, this.last);\r\n    }\r\n    static getValues(items, first, last) {\r\n        return Array.from(new Set(items.reduce((values, item) => {\r\n            values.push(...item.values(first, last));\r\n            return values;\r\n        }, []))).sort(sortAsc);\r\n    }\r\n}\r\nclass FieldItem {\r\n    constructor() {\r\n        this.step = 1;\r\n    }\r\n    values(first, last) {\r\n        const start = this.range ? this.range.from : first, end = (this.range && this.range.to !== undefined) ? this.range.to : last, rangeLength = (end < start) ? ((last - start) + (end - first) + 1) : (end - start);\r\n        return Array(Math.floor(rangeLength / this.step) + 1)\r\n            .fill(0)\r\n            .map((_, i) => first + ((start - first + (this.step * i)) % (last - first + 1)));\r\n    }\r\n    get any() {\r\n        return this.range === undefined && this.step === 1;\r\n    }\r\n    get single() {\r\n        return !!this.range && this.range.from === this.range.to;\r\n    }\r\n    static parse(item, first, last, allowCyclicRange = false, transformer) {\r\n        const fieldItem = new FieldItem();\r\n        const [match, all, startFrom, range, step] = (item.match(/^(?:(\\*)|([0-9]+)|([0-9]+-[0-9]+))(?:\\/([1-9][0-9]*))?$/) || []);\r\n        if (!match)\r\n            throw new Error('Field item invalid format');\r\n        if (step) {\r\n            fieldItem.step = parseInt(step, 10);\r\n        }\r\n        if (startFrom) {\r\n            let start = parseInt(startFrom, 10);\r\n            start = transformer ? transformer(start) : start;\r\n            if (start < first || start > last)\r\n                throw new Error('Field item out of valid value range');\r\n            fieldItem.range = {\r\n                from: start,\r\n                to: step ? undefined : start\r\n            };\r\n        }\r\n        else if (range) {\r\n            const [rangeStart, rangeEnd] = range.split('-').map(x => {\r\n                const n = parseInt(x, 10);\r\n                return transformer ? transformer(n) : n;\r\n            });\r\n            if (rangeStart < first || rangeStart > last || rangeEnd < first || rangeEnd > last ||\r\n                (rangeEnd < rangeStart && !allowCyclicRange)) {\r\n                throw new Error('Field item range invalid, either value out of valid range or start greater than end in non wraparound field');\r\n            }\r\n            fieldItem.range = {\r\n                from: rangeStart,\r\n                to: rangeEnd\r\n            };\r\n        }\r\n        return fieldItem;\r\n    }\r\n}\r\nexport class SecondsOrMinutesField extends Field {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.first = 0;\r\n        this.last = 59;\r\n    }\r\n}\r\nexport class HoursField extends Field {\r\n    constructor() {\r\n        super(...arguments);\r\n        this.first = 0;\r\n        this.last = 23;\r\n    }\r\n}\r\nexport class DaysField {\r\n    constructor(daysOfMonthField, daysOfWeekField) {\r\n        this.lastDay = false;\r\n        this.lastWeekday = false;\r\n        this.daysItems = [];\r\n        this.nearestWeekdayItems = [];\r\n        this.daysOfWeekItems = [];\r\n        this.lastDaysOfWeekItems = [];\r\n        this.nthDaysOfWeekItems = [];\r\n        for (let item of daysOfMonthField.split(',').map(s => s === '?' ? '*' : s)) {\r\n            if (item === 'l') {\r\n                this.lastDay = true;\r\n            }\r\n            else if (item === 'lw') {\r\n                this.lastWeekday = true;\r\n            }\r\n            else if (item.endsWith('w')) {\r\n                this.nearestWeekdayItems.push(FieldItem.parse(item.slice(0, -1), 1, 31));\r\n            }\r\n            else {\r\n                this.daysItems.push(FieldItem.parse(item, 1, 31));\r\n            }\r\n        }\r\n        const normalisedDaysOfWeekField = daysOfWeekField.replace(dayOfWeekReplacementRegex, match => dayOfWeekReplacements.indexOf(match) + '');\r\n        const parseDayOfWeek = (item) => FieldItem.parse(item, 0, 6, true, n => n === 7 ? 0 : n);\r\n        for (let item of normalisedDaysOfWeekField.split(',').map(s => s === '?' ? '*' : s)) {\r\n            const nthIndex = item.lastIndexOf('#');\r\n            if (item.endsWith('l')) {\r\n                this.lastDaysOfWeekItems.push(parseDayOfWeek(item.slice(0, -1)));\r\n            }\r\n            else if (nthIndex !== -1) {\r\n                const nth = item.slice(nthIndex + 1);\r\n                if (!/^[1-5]$/.test(nth))\r\n                    throw new Error('Field item nth of month (#) invalid');\r\n                this.nthDaysOfWeekItems.push({\r\n                    item: parseDayOfWeek(item.slice(0, nthIndex)),\r\n                    nth: parseInt(nth, 10)\r\n                });\r\n            }\r\n            else {\r\n                this.daysOfWeekItems.push(parseDayOfWeek(item));\r\n            }\r\n        }\r\n    }\r\n    get values() {\r\n        return DaysFieldValues.fromField(this);\r\n    }\r\n    get allDays() {\r\n        return (!this.lastDay &&\r\n            !this.lastWeekday &&\r\n            !this.nearestWeekdayItems.length &&\r\n            !this.lastDaysOfWeekItems.length &&\r\n            !this.nthDaysOfWeekItems.length &&\r\n            this.daysItems.length === 1 && this.daysItems[0].any &&\r\n            this.daysOfWeekItems.length === 1 && this.daysOfWeekItems[0].any);\r\n    }\r\n}\r\nexport class DaysFieldValues {\r\n    constructor() {\r\n        this.lastDay = false;\r\n        this.lastWeekday = false;\r\n        this.days = [];\r\n        this.nearestWeekday = [];\r\n        this.daysOfWeek = [];\r\n        this.lastDaysOfWeek = [];\r\n        this.nthDaysOfWeek = [];\r\n    }\r\n    static fromField(field) {\r\n        const values = new DaysFieldValues();\r\n        const filterAnyItems = (items) => items.filter(item => !item.any);\r\n        values.lastDay = field.lastDay;\r\n        values.lastWeekday = field.lastWeekday;\r\n        values.days = Field.getValues(field.allDays ? [new FieldItem()] : filterAnyItems(field.daysItems), 1, 31);\r\n        values.nearestWeekday = Field.getValues(field.nearestWeekdayItems, 1, 31);\r\n        values.daysOfWeek = Field.getValues(filterAnyItems(field.daysOfWeekItems), 0, 6);\r\n        values.lastDaysOfWeek = Field.getValues(field.lastDaysOfWeekItems, 0, 6);\r\n        const nthDaysHashes = new Set();\r\n        for (let item of field.nthDaysOfWeekItems) {\r\n            for (let n of item.item.values(0, 6)) {\r\n                let hash = n * 10 + item.nth;\r\n                if (!nthDaysHashes.has(hash)) {\r\n                    nthDaysHashes.add(hash);\r\n                    values.nthDaysOfWeek.push([n, item.nth]);\r\n                }\r\n            }\r\n        }\r\n        return values;\r\n    }\r\n    getDays(year, month) {\r\n        const days = new Set(this.days);\r\n        const lastDateOfMonth = new Date(year, month, 0).getDate();\r\n        const firstDayOfWeek = new Date(year, month - 1, 1).getDay();\r\n        const getNearestWeekday = (day) => {\r\n            if (day > lastDateOfMonth)\r\n                day = lastDateOfMonth;\r\n            const dayOfWeek = (day + firstDayOfWeek - 1) % 7;\r\n            let weekday = day + (dayOfWeek === 0 ? 1 : (dayOfWeek === 6 ? -1 : 0));\r\n            return weekday + (weekday < 1 ? 3 : (weekday > lastDateOfMonth ? -3 : 0));\r\n        };\r\n        if (this.lastDay) {\r\n            days.add(lastDateOfMonth);\r\n        }\r\n        if (this.lastWeekday) {\r\n            days.add(getNearestWeekday(lastDateOfMonth));\r\n        }\r\n        for (const day of this.nearestWeekday) {\r\n            days.add(getNearestWeekday(day));\r\n        }\r\n        if (this.daysOfWeek.length ||\r\n            this.lastDaysOfWeek.length ||\r\n            this.nthDaysOfWeek.length) {\r\n            const daysOfWeek = Array(7).fill(0).map(() => ([]));\r\n            for (let day = 1; day < 36; day++) {\r\n                daysOfWeek[(day + firstDayOfWeek - 1) % 7].push(day);\r\n            }\r\n            for (const dayOfWeek of this.daysOfWeek) {\r\n                for (const day of daysOfWeek[dayOfWeek]) {\r\n                    days.add(day);\r\n                }\r\n            }\r\n            for (const dayOfWeek of this.lastDaysOfWeek) {\r\n                for (let i = daysOfWeek[dayOfWeek].length - 1; i >= 0; i--) {\r\n                    if (daysOfWeek[dayOfWeek][i] <= lastDateOfMonth) {\r\n                        days.add(daysOfWeek[dayOfWeek][i]);\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            for (const [dayOfWeek, nthOfMonth] of this.nthDaysOfWeek) {\r\n                days.add(daysOfWeek[dayOfWeek][nthOfMonth - 1]);\r\n            }\r\n        }\r\n        return Array.from(days).filter(day => day <= lastDateOfMonth).sort(sortAsc);\r\n    }\r\n}\r\nexport class MonthsField extends Field {\r\n    constructor(field) {\r\n        super(field.replace(monthReplacementRegex, match => {\r\n            return monthReplacements.indexOf(match) + 1 + '';\r\n        }));\r\n        this.first = 1;\r\n        this.last = 12;\r\n    }\r\n}\r\nexport class YearsField extends Field {\r\n    constructor(field) {\r\n        super(field);\r\n        this.first = 1970;\r\n        this.last = 2099;\r\n        this.items;\r\n    }\r\n    parse() {\r\n        return this.field.split(',')\r\n            .map(item => FieldItem.parse(item, 0, maxValidYear));\r\n    }\r\n    nextYear(fromYear) {\r\n        return this.items.reduce((years, item) => {\r\n            if (item.any)\r\n                years.push(fromYear);\r\n            else if (item.single) {\r\n                const year = item.range.from;\r\n                if (year >= fromYear)\r\n                    years.push(year);\r\n            }\r\n            else {\r\n                const start = item.range && item.range.from || this.first;\r\n                if (start > fromYear)\r\n                    years.push(start);\r\n                else {\r\n                    const nextYear = start + Math.ceil((fromYear - start) / item.step) * item.step;\r\n                    if (nextYear <= (item.range && item.range.to || maxValidYear))\r\n                        years.push(nextYear);\r\n                }\r\n            }\r\n            return years;\r\n        }, []).sort(sortAsc)[0] || null;\r\n    }\r\n}\r\n//# sourceMappingURL=parser.js.map","export class CronosDate {\r\n    constructor(year, month = 1, day = 1, hour = 0, minute = 0, second = 0) {\r\n        this.year = year;\r\n        this.month = month;\r\n        this.day = day;\r\n        this.hour = hour;\r\n        this.minute = minute;\r\n        this.second = second;\r\n    }\r\n    static fromDate(date, timezone) {\r\n        if (!timezone) {\r\n            return new CronosDate(date.getFullYear(), date.getMonth() + 1, date.getDate(), date.getHours(), date.getMinutes(), date.getSeconds());\r\n        }\r\n        return timezone['nativeDateToCronosDate'](date);\r\n    }\r\n    toDate(timezone) {\r\n        if (!timezone) {\r\n            return new Date(this.year, this.month - 1, this.day, this.hour, this.minute, this.second);\r\n        }\r\n        return timezone['cronosDateToNativeDate'](this);\r\n    }\r\n    static fromUTCTimestamp(timestamp) {\r\n        const date = new Date(timestamp);\r\n        return new CronosDate(date.getUTCFullYear(), date.getUTCMonth() + 1, date.getUTCDate(), date.getUTCHours(), date.getUTCMinutes(), date.getUTCSeconds());\r\n    }\r\n    toUTCTimestamp() {\r\n        return Date.UTC(this.year, this.month - 1, this.day, this.hour, this.minute, this.second);\r\n    }\r\n    copyWith({ year = this.year, month = this.month, day = this.day, hour = this.hour, minute = this.minute, second = this.second } = {}) {\r\n        return new CronosDate(year, month, day, hour, minute, second);\r\n    }\r\n}\r\n// Adapted from Intl.DateTimeFormat timezone handling in https://github.com/moment/luxon\r\nconst ZoneCache = new Map();\r\nexport class CronosTimezone {\r\n    constructor(IANANameOrOffset) {\r\n        if (typeof IANANameOrOffset === 'number') {\r\n            if (IANANameOrOffset > 840 || IANANameOrOffset < -840)\r\n                throw new Error('Invalid offset');\r\n            this.fixedOffset = IANANameOrOffset;\r\n            return this;\r\n        }\r\n        const offsetMatch = IANANameOrOffset.match(/^([+-]?)(0[1-9]|1[0-4])(?::?([0-5][0-9]))?$/);\r\n        if (offsetMatch) {\r\n            this.fixedOffset = (offsetMatch[1] === '-' ? -1 : 1) * ((parseInt(offsetMatch[2], 10) * 60) + (parseInt(offsetMatch[3], 10) || 0));\r\n            return this;\r\n        }\r\n        if (ZoneCache.has(IANANameOrOffset)) {\r\n            return ZoneCache.get(IANANameOrOffset);\r\n        }\r\n        try {\r\n            this.dateTimeFormat = new Intl.DateTimeFormat(\"en-US\", {\r\n                hour12: false,\r\n                timeZone: IANANameOrOffset,\r\n                year: \"numeric\",\r\n                month: \"2-digit\",\r\n                day: \"2-digit\",\r\n                hour: \"2-digit\",\r\n                minute: \"2-digit\",\r\n                second: \"2-digit\"\r\n            });\r\n        }\r\n        catch (err) {\r\n            throw new Error('Invalid IANA name or offset');\r\n        }\r\n        this.zoneName = IANANameOrOffset;\r\n        const currentYear = new Date().getUTCFullYear();\r\n        this.winterOffset = this.offset(Date.UTC(currentYear, 0, 1));\r\n        this.summerOffset = this.offset(Date.UTC(currentYear, 5, 1));\r\n        ZoneCache.set(IANANameOrOffset, this);\r\n    }\r\n    toString() {\r\n        if (this.fixedOffset) {\r\n            const absOffset = Math.abs(this.fixedOffset);\r\n            return [\r\n                this.fixedOffset < 0 ? '-' : '+',\r\n                Math.floor(absOffset / 60).toString().padStart(2, '0'),\r\n                (absOffset % 60).toString().padStart(2, '0')\r\n            ].join('');\r\n        }\r\n        return this.zoneName;\r\n    }\r\n    offset(ts) {\r\n        if (!this.dateTimeFormat)\r\n            return this.fixedOffset || 0;\r\n        const date = new Date(ts);\r\n        const { year, month, day, hour, minute, second } = this.nativeDateToCronosDate(date);\r\n        const asUTC = Date.UTC(year, month - 1, day, hour, minute, second), asTS = ts - (ts % 1000);\r\n        return (asUTC - asTS) / 60000;\r\n    }\r\n    nativeDateToCronosDate(date) {\r\n        if (!this.dateTimeFormat) {\r\n            return CronosDate['fromUTCTimestamp'](date.getTime() + (this.fixedOffset || 0) * 60000);\r\n        }\r\n        return this.dateTimeFormat.formatToParts\r\n            ? partsOffset(this.dateTimeFormat, date)\r\n            : hackyOffset(this.dateTimeFormat, date);\r\n    }\r\n    cronosDateToNativeDate(date) {\r\n        if (!this.dateTimeFormat) {\r\n            return new Date(date['toUTCTimestamp']() - (this.fixedOffset || 0) * 60000);\r\n        }\r\n        const provisionalOffset = ((date.month > 3 || date.month < 11) ? this.summerOffset : this.winterOffset) || 0;\r\n        const UTCTimestamp = date['toUTCTimestamp']();\r\n        // Find the right offset a given local time.\r\n        // Our UTC time is just a guess because our offset is just a guess\r\n        let utcGuess = UTCTimestamp - provisionalOffset * 60000;\r\n        // Test whether the zone matches the offset for this ts\r\n        const o2 = this.offset(utcGuess);\r\n        // If so, offset didn't change and we're done\r\n        if (provisionalOffset === o2)\r\n            return new Date(utcGuess);\r\n        // If not, change the ts by the difference in the offset\r\n        utcGuess -= (o2 - provisionalOffset) * 60000;\r\n        // If that gives us the local time we want, we're done\r\n        const o3 = this.offset(utcGuess);\r\n        if (o2 === o3)\r\n            return new Date(utcGuess);\r\n        // If it's different, we're in a hole time. The offset has changed, but the we don't adjust the time\r\n        return new Date(UTCTimestamp - Math.min(o2, o3) * 60000);\r\n    }\r\n}\r\nfunction hackyOffset(dtf, date) {\r\n    const formatted = dtf.format(date).replace(/\\u200E/g, \"\"), parsed = formatted.match(/(\\d+)\\/(\\d+)\\/(\\d+),? (\\d+):(\\d+):(\\d+)/), [, month, day, year, hour, minute, second] = (parsed || []).map(n => parseInt(n, 10));\r\n    return new CronosDate(year, month, day, hour, minute, second);\r\n}\r\nfunction partsOffset(dtf, date) {\r\n    const formatted = dtf.formatToParts(date);\r\n    return new CronosDate(parseInt(formatted[4].value, 10), parseInt(formatted[0].value, 10), parseInt(formatted[2].value, 10), parseInt(formatted[6].value, 10), parseInt(formatted[8].value, 10), parseInt(formatted[10].value, 10));\r\n}\r\n//# sourceMappingURL=date.js.map","import { _parse } from './parser';\r\nimport { CronosDate, CronosTimezone } from './date';\r\nconst hourinms = 60 * 60 * 1000;\r\nconst findFirstFrom = (from, list) => list.findIndex(n => n >= from);\r\nexport class CronosExpression {\r\n    constructor(cronString, seconds, minutes, hours, days, months, years) {\r\n        this.cronString = cronString;\r\n        this.seconds = seconds;\r\n        this.minutes = minutes;\r\n        this.hours = hours;\r\n        this.days = days;\r\n        this.months = months;\r\n        this.years = years;\r\n        this.skipRepeatedHour = true;\r\n        this.missingHour = 'insert';\r\n    }\r\n    static parse(cronstring, options = {}) {\r\n        const expr = _parse(cronstring);\r\n        expr.timezone = options.timezone instanceof CronosTimezone ? options.timezone :\r\n            (options.timezone !== undefined ? new CronosTimezone(options.timezone) : undefined);\r\n        expr.skipRepeatedHour = options.skipRepeatedHour !== undefined ? options.skipRepeatedHour : expr.skipRepeatedHour;\r\n        expr.missingHour = options.missingHour || expr.missingHour;\r\n        return expr;\r\n    }\r\n    toString() {\r\n        const showTzOpts = !this.timezone || this.timezone.zoneName;\r\n        const timezone = Object.entries({\r\n            tz: this.timezone && this.timezone.toString() || 'Local',\r\n            skipRepeatedHour: showTzOpts && this.skipRepeatedHour.toString(),\r\n            missingHour: showTzOpts && this.missingHour,\r\n        }).map(([key, val]) => val && key + ': ' + val).filter(s => s).join(', ');\r\n        return `${this.cronString} (${timezone})`;\r\n    }\r\n    nextDate(afterDate = new Date()) {\r\n        const fromCronosDate = CronosDate.fromDate(afterDate, this.timezone);\r\n        if (this.timezone && this.timezone.fixedOffset !== undefined) {\r\n            return this._next(fromCronosDate).date;\r\n        }\r\n        const fromTimestamp = afterDate.getTime(), fromLocalTimestamp = fromCronosDate['toUTCTimestamp'](), prevHourLocalTimestamp = CronosDate.fromDate(new Date(fromTimestamp - hourinms), this.timezone)['toUTCTimestamp'](), nextHourLocalTimestamp = CronosDate.fromDate(new Date(fromTimestamp + hourinms), this.timezone)['toUTCTimestamp'](), nextHourRepeated = nextHourLocalTimestamp - fromLocalTimestamp === 0, thisHourRepeated = fromLocalTimestamp - prevHourLocalTimestamp === 0, thisHourMissing = fromLocalTimestamp - prevHourLocalTimestamp === hourinms * 2;\r\n        if (this.skipRepeatedHour && thisHourRepeated) {\r\n            return this._next(fromCronosDate.copyWith({ minute: 59, second: 60 }), false).date;\r\n        }\r\n        if (this.missingHour === 'offset' && thisHourMissing) {\r\n            const nextDate = this._next(fromCronosDate.copyWith({ hour: fromCronosDate.hour - 1 })).date;\r\n            if (!nextDate || nextDate.getTime() > fromTimestamp)\r\n                return nextDate;\r\n        }\r\n        let { date: nextDate, cronosDate: nextCronosDate } = this._next(fromCronosDate);\r\n        if (this.missingHour !== 'offset' && nextCronosDate && nextDate) {\r\n            const nextDateNextHourTimestamp = nextCronosDate.copyWith({ hour: nextCronosDate.hour + 1 }).toDate(this.timezone).getTime();\r\n            if (nextDateNextHourTimestamp === nextDate.getTime()) {\r\n                if (this.missingHour === 'insert') {\r\n                    return nextCronosDate.copyWith({ minute: 0, second: 0 }).toDate(this.timezone);\r\n                }\r\n                // this.missingHour === 'skip'\r\n                return this._next(nextCronosDate.copyWith({ minute: 59, second: 59 })).date;\r\n            }\r\n        }\r\n        if (!this.skipRepeatedHour) {\r\n            if (nextHourRepeated && (!nextDate || (nextDate.getTime() > fromTimestamp + hourinms))) {\r\n                nextDate = this._next(fromCronosDate.copyWith({ minute: 0, second: 0 }), false).date;\r\n            }\r\n            if (nextDate && nextDate < afterDate) {\r\n                nextDate = new Date(nextDate.getTime() + hourinms);\r\n            }\r\n        }\r\n        return nextDate;\r\n    }\r\n    _next(date, after = true) {\r\n        const nextDate = this._nextYear(after ? date.copyWith({ second: date.second + 1 }) : date);\r\n        return {\r\n            cronosDate: nextDate,\r\n            date: nextDate ? nextDate.toDate(this.timezone) : null\r\n        };\r\n    }\r\n    nextNDates(afterDate = new Date(), n = 5) {\r\n        const dates = [];\r\n        let lastDate = afterDate;\r\n        for (let i = 0; i < n; i++) {\r\n            const date = this.nextDate(lastDate);\r\n            if (!date)\r\n                break;\r\n            lastDate = date;\r\n            dates.push(date);\r\n        }\r\n        return dates;\r\n    }\r\n    _nextYear(fromDate) {\r\n        let year = fromDate.year;\r\n        let nextDate = null;\r\n        while (!nextDate) {\r\n            year = this.years.nextYear(year);\r\n            if (year === null)\r\n                return null;\r\n            nextDate = this._nextMonth((year === fromDate.year) ? fromDate : new CronosDate(year));\r\n            year++;\r\n        }\r\n        return nextDate;\r\n    }\r\n    _nextMonth(fromDate) {\r\n        let nextMonthIndex = findFirstFrom(fromDate.month, this.months);\r\n        let nextDate = null;\r\n        while (!nextDate) {\r\n            const nextMonth = this.months[nextMonthIndex];\r\n            if (nextMonth === undefined)\r\n                return null;\r\n            nextDate = this._nextDay((nextMonth === fromDate.month) ? fromDate : new CronosDate(fromDate.year, nextMonth));\r\n            nextMonthIndex++;\r\n        }\r\n        return nextDate;\r\n    }\r\n    _nextDay(fromDate) {\r\n        const days = this.days.getDays(fromDate.year, fromDate.month);\r\n        let nextDayIndex = findFirstFrom(fromDate.day, days);\r\n        let nextDate = null;\r\n        while (!nextDate) {\r\n            const nextDay = days[nextDayIndex];\r\n            if (nextDay === undefined)\r\n                return null;\r\n            nextDate = this._nextHour((nextDay === fromDate.day) ? fromDate : new CronosDate(fromDate.year, fromDate.month, nextDay));\r\n            nextDayIndex++;\r\n        }\r\n        return nextDate;\r\n    }\r\n    _nextHour(fromDate) {\r\n        let nextHourIndex = findFirstFrom(fromDate.hour, this.hours);\r\n        let nextDate = null;\r\n        while (!nextDate) {\r\n            const nextHour = this.hours[nextHourIndex];\r\n            if (nextHour === undefined)\r\n                return null;\r\n            nextDate = this._nextMinute((nextHour === fromDate.hour) ? fromDate :\r\n                new CronosDate(fromDate.year, fromDate.month, fromDate.day, nextHour));\r\n            nextHourIndex++;\r\n        }\r\n        return nextDate;\r\n    }\r\n    _nextMinute(fromDate) {\r\n        let nextMinuteIndex = findFirstFrom(fromDate.minute, this.minutes);\r\n        let nextDate = null;\r\n        while (!nextDate) {\r\n            const nextMinute = this.minutes[nextMinuteIndex];\r\n            if (nextMinute === undefined)\r\n                return null;\r\n            nextDate = this._nextSecond((nextMinute === fromDate.minute) ? fromDate :\r\n                new CronosDate(fromDate.year, fromDate.month, fromDate.day, fromDate.hour, nextMinute));\r\n            nextMinuteIndex++;\r\n        }\r\n        return nextDate;\r\n    }\r\n    _nextSecond(fromDate) {\r\n        const nextSecondIndex = findFirstFrom(fromDate.second, this.seconds), nextSecond = this.seconds[nextSecondIndex];\r\n        if (nextSecond === undefined)\r\n            return null;\r\n        return fromDate.copyWith({ second: nextSecond });\r\n    }\r\n}\r\n//# sourceMappingURL=expression.js.map","const maxTimeout = Math.pow(2, 31) - 1;\r\nconst scheduledTasks = [];\r\nlet runningTimer = null;\r\nfunction addTask(task) {\r\n    if (task['_timestamp']) {\r\n        const insertIndex = scheduledTasks.findIndex(t => (t['_timestamp'] || 0) < (task['_timestamp'] || 0));\r\n        if (insertIndex >= 0)\r\n            scheduledTasks.splice(insertIndex, 0, task);\r\n        else\r\n            scheduledTasks.push(task);\r\n    }\r\n}\r\nfunction removeTask(task) {\r\n    const removeIndex = scheduledTasks.indexOf(task);\r\n    if (removeIndex >= 0)\r\n        scheduledTasks.splice(removeIndex, 1);\r\n    if (scheduledTasks.length === 0 && runningTimer) {\r\n        clearTimeout(runningTimer);\r\n        runningTimer = null;\r\n    }\r\n}\r\nfunction runScheduledTasks() {\r\n    if (runningTimer)\r\n        clearTimeout(runningTimer);\r\n    const now = Date.now();\r\n    const removeIndex = scheduledTasks.findIndex(task => (task['_timestamp'] || 0) <= now);\r\n    const tasksToRun = removeIndex >= 0 ? scheduledTasks.splice(removeIndex) : [];\r\n    for (let task of tasksToRun) {\r\n        task['_runTask']();\r\n        if (task.isRunning) {\r\n            task['_updateTimestamp']();\r\n            addTask(task);\r\n        }\r\n    }\r\n    const nextTask = scheduledTasks[scheduledTasks.length - 1];\r\n    if (nextTask) {\r\n        runningTimer = setTimeout(runScheduledTasks, Math.min((nextTask['_timestamp'] || 0) - Date.now(), maxTimeout));\r\n    }\r\n    else\r\n        runningTimer = null;\r\n}\r\nclass DateArraySequence {\r\n    constructor(dateLikes) {\r\n        this._dates = dateLikes.map(dateLike => {\r\n            const date = new Date(dateLike);\r\n            if (isNaN(date.getTime()))\r\n                throw new Error('Invalid date');\r\n            return date;\r\n        }).sort((a, b) => a.getTime() - b.getTime());\r\n    }\r\n    nextDate(afterDate) {\r\n        const nextIndex = this._dates.findIndex(d => d > afterDate);\r\n        return nextIndex === -1 ? null : this._dates[nextIndex];\r\n    }\r\n}\r\nexport class CronosTask {\r\n    constructor(sequenceOrDates) {\r\n        this._listeners = {\r\n            'started': new Set(),\r\n            'stopped': new Set(),\r\n            'run': new Set(),\r\n            'ended': new Set(),\r\n        };\r\n        if (Array.isArray(sequenceOrDates))\r\n            this._sequence = new DateArraySequence(sequenceOrDates);\r\n        else if (typeof sequenceOrDates === 'string' ||\r\n            typeof sequenceOrDates === 'number' ||\r\n            sequenceOrDates instanceof Date)\r\n            this._sequence = new DateArraySequence([sequenceOrDates]);\r\n        else\r\n            this._sequence = sequenceOrDates;\r\n    }\r\n    start() {\r\n        this._updateTimestamp();\r\n        addTask(this);\r\n        runScheduledTasks();\r\n        if (this._timestamp)\r\n            this._emit('started');\r\n        return this;\r\n    }\r\n    stop() {\r\n        this._timestamp = undefined;\r\n        removeTask(this);\r\n        this._emit('stopped');\r\n        return this;\r\n    }\r\n    get nextRun() {\r\n        return this._timestamp ? new Date(this._timestamp) : undefined;\r\n    }\r\n    get isRunning() {\r\n        return !!this._timestamp;\r\n    }\r\n    _runTask() {\r\n        this._emit('run', this._timestamp);\r\n    }\r\n    _updateTimestamp() {\r\n        const nextDate = this._sequence.nextDate(this._timestamp ? new Date(this._timestamp) : new Date());\r\n        let timestamp = nextDate ? nextDate.getTime() : undefined;\r\n        if (this._timestamp && timestamp && timestamp < (this._timestamp + 1000))\r\n            timestamp = this._timestamp + 1000;\r\n        this._timestamp = timestamp;\r\n        if (!this._timestamp)\r\n            this._emit('ended');\r\n    }\r\n    on(event, listener) {\r\n        this._listeners[event].add(listener);\r\n        return this;\r\n    }\r\n    off(event, listener) {\r\n        this._listeners[event].delete(listener);\r\n        return this;\r\n    }\r\n    _emit(event, ...args) {\r\n        this._listeners[event].forEach((listener) => {\r\n            listener.call(this, ...args);\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=scheduler.js.map","import { CronosExpression } from './expression';\r\nimport { CronosTask } from './scheduler';\r\nimport { CronosTimezone } from './date';\r\nexport function scheduleTask(cronString, task, options) {\r\n    const expression = CronosExpression.parse(cronString, options);\r\n    return new CronosTask(expression)\r\n        .on('run', task)\r\n        .start();\r\n}\r\nexport function validate(cronString) {\r\n    try {\r\n        CronosExpression.parse(cronString);\r\n    }\r\n    catch {\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nexport { CronosExpression, CronosTask, CronosTimezone };\r\n//# sourceMappingURL=index.js.map"],"names":[],"mappings":"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"}